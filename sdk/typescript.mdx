---
title: TypeScript SDK
description: "Drop-in replacement for Claude Agent SDK"
---

## Installation

```bash
npm install raysurfer
```

## Setup

Set your API key:

```bash
export RAYSURFER_API_KEY=your_api_key_here
```

Get your key from the [dashboard](https://raysurfer.com/dashboard/api-keys).

## Usage

Swap your client class and method names. Options come directly from `@anthropic-ai/claude-agent-sdk`:

```typescript
// Before
import { ClaudeSDKClient, ClaudeAgentOptions } from "@anthropic-ai/claude-agent-sdk";

// After
import { RaysurferClient } from "raysurfer";
import { ClaudeAgentOptions } from "@anthropic-ai/claude-agent-sdk";

const options: ClaudeAgentOptions = {
  allowedTools: ["Read", "Write", "Bash"],
  systemPrompt: "You are a helpful assistant.",
};

const client = new RaysurferClient(options);

for await (const msg of client.raysurferQuery("Generate quarterly report")) {
  console.log(msg);
}
```

## Method Mapping

| Claude SDK | Raysurfer |
|------------|-----------|
| `new ClaudeSDKClient(options)` | `new RaysurferClient(options)` |
| `client.query(prompt)` | `client.raysurferQuery(prompt)` |

## Options

Options are passed through directly from `@anthropic-ai/claude-agent-sdk`. All standard options work:

```typescript
import { ClaudeAgentOptions } from "@anthropic-ai/claude-agent-sdk";

const options: ClaudeAgentOptions = {
  allowedTools: ["Read", "Write", "Bash"],
  systemPrompt: "You are a helpful assistant.",
  model: "claude-sonnet-4-20250514",
  maxTurns: 10,
  cwd: "/path/to/working/dir",
  // ... all other ClaudeAgentOptions fields
};
```

Caching is enabled automatically when `RAYSURFER_API_KEY` is set.

## Snippet Retrieval Scope

Control which cached snippets are retrieved using `publicSnips` and `snipsDesired`:

```typescript
import { RaysurferClient } from "raysurfer";
import { ClaudeAgentOptions } from "@anthropic-ai/claude-agent-sdk";

const options: ClaudeAgentOptions = {
  allowedTools: ["Read", "Write", "Bash"],
};

// Include both public and company snippets
const client = new RaysurferClient(options, {
  publicSnips: true,        // Include public/shared snippets
  snipsDesired: "company",  // Also include company-level snippets
});

// Enterprise: Retrieve client-specific snippets only
const enterpriseClient = new RaysurferClient(options, {
  snipsDesired: "client",   // Client workspace snippets (Enterprise only)
});
```

| Configuration | Required Tier |
|--------------|---------------|
| `publicSnips: true` only | FREE (default) |
| `snipsDesired: "company"` | TEAM or ENTERPRISE |
| `snipsDesired: "client"` | ENTERPRISE only |

**Default behavior:** FREE tier gets public snippets only. TEAM/ENTERPRISE tiers get company snippets by default (no public). Add `publicSnips: true` to include public snippets on top of your tier's default.

## Full Example

```typescript
import { RaysurferClient } from "raysurfer";
import { ClaudeAgentOptions } from "@anthropic-ai/claude-agent-sdk";

process.env.RAYSURFER_API_KEY = "your_api_key";

const options: ClaudeAgentOptions = {
  allowedTools: ["Read", "Write", "Bash"],
  systemPrompt: "You are a helpful assistant.",
};

const client = new RaysurferClient(options);

// First run: generates and caches code
for await (const msg of client.raysurferQuery("Fetch GitHub trending repos")) {
  console.log(msg);
}

// Second run: retrieves from cache (instant)
for await (const msg of client.raysurferQuery("Fetch GitHub trending repos")) {
  console.log(msg);
}
```

## Without Caching

If `RAYSURFER_API_KEY` is not set, `RaysurferClient` behaves exactly like `ClaudeSDKClient` â€” no caching, just a pass-through wrapper.

## Low-Level API

For custom integrations, use the `RaySurfer` client directly.

### Complete Low-Level Example with Anthropic API

```typescript
import Anthropic from "@anthropic-ai/sdk";
import { RaySurfer } from "raysurfer";

const client = new RaySurfer({ apiKey: "your_raysurfer_api_key" });
const task = "Fetch GitHub trending repos";

// 1. Retrieve cached code files for a task
const result = await client.getCodeFiles({
  task,
  topK: 5,
  minVerdictScore: 0.3,
});

// result.addToLlmPrompt contains a pre-formatted string like:
// "\n\nYou have access to pre-written code files:\n- .raysurfer_code/github_fetcher.ts: Fetches trending repos\n..."

// Augment your system prompt with cached code context
const basePrompt = "You are a helpful coding assistant.";
const augmentedPrompt = basePrompt + result.addToLlmPrompt;

// Make your Anthropic API call with the augmented prompt
const anthropic = new Anthropic();
const response = await anthropic.messages.create({
  model: "claude-sonnet-4-20250514",
  max_tokens: 1024,
  system: augmentedPrompt,
  messages: [{ role: "user", content: "Fetch the top 10 trending GitHub repos" }],
});

console.log(response.content[0].text);

// 2. Upload new code snippets after execution
await client.uploadNewCodeSnips(
  task,
  [{ path: "fetch_repos.ts", content: "function fetch() { ... }" }],
  true // succeeded
);

// 3. Vote on whether a cached snippet was useful
await client.voteCodeSnip({
  task,
  codeBlockId: result.files[0].codeBlockId,
  codeBlockName: result.files[0].filename,
  codeBlockDescription: result.files[0].description,
  succeeded: true,
});
```

### Response Fields

The `getCodeFiles()` response includes:

| Field | Type | Description |
|-------|------|-------------|
| `files` | `CodeFile[]` | Retrieved code files with metadata |
| `task` | `string` | The task that was searched |
| `totalFound` | `number` | Total matches found |
| `addToLlmPrompt` | `string` | Pre-formatted string to append to your LLM system prompt |

Each `CodeFile` contains `codeBlockId`, `filename`, `source`, `description`, `verdictScore`, `thumbsUp`, `thumbsDown`, and `similarityScore`.

### Method Reference

| Method | Description |
|--------|-------------|
| `getCodeFiles({ task, topK?, minVerdictScore?, preferComplete?, cacheDir? })` | Retrieve cached code files with `addToLlmPrompt` for LLM augmentation |
| `getCodeSnips({ task, topK?, minVerdictScore? })` | Retrieve cached code snippets by semantic search |
| `uploadNewCodeSnips(task, filesWritten, succeeded)` | Store new code files for future reuse |
| `voteCodeSnip({ task, codeBlockId, codeBlockName, codeBlockDescription, succeeded })` | Vote on snippet usefulness (triggers async backend voting) |
